<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SkillSwap - Trade Skills, Grow Together</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.22.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');
    body {
      font-family: 'Roboto', sans-serif;
      background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cg opacity='0.2'%3E%3Csvg x='10' y='10' width='20' height='20' fill='none' stroke='%234b5e40' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M10 4v12m0-12C8.895 3.5 7.343 3 5.5 3s-3.395.5-4.5 1v12c1.105-.5 2.657-1 4.5-1s3.395.5 4.5 1m0-12c1.105-.5 2.657-1 4.5-1s3.395.5 4.5 1v12c-1.105-.5-2.657-1-4.5-1s-3.395.5-4.5 1'/%3E%3Cpath stroke='%23d4a017' d='M7 7h6'/%3E%3C/svg%3E%3Csvg x='40' y='10' width='20' height='20' fill='none' stroke='%234b5e40' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M7.75 14L7 16l-.5.5h6l-.5-.5-.75-2M2 11h16M3 14h14a1.5 1.5 0 001.5-1.5V4a1.5 1.5 0 00-1.5-1.5H3A1.5 1.5 0 001.5 4v8.5A1.5 1.5 0 003 14z'/%3E%3Cpath stroke='%23d4a017' d='M6 5h8m-4 3h0'/%3E%3C/svg%3E%3Csvg x='70' y='10' width='20' height='20' fill='none' stroke='%234b5e40' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M7.663 14h3.673M10 2v1m5.364 1.364l-.5.5M18 10h-1M3 10H2m2.343-4.636l-.5-.5m2.828 7.9a4 4 0 115.072 0l-.4.4A2.874 2.874 0 0012 15.469V16a1.5 1.5 0 11-3 0v-.531c0-.67-.268-1.316-.738-1.789l-.4-.4z'/%3E%3Cpath stroke='%23d4a017' d='M10 7v2m0 3h.01'/%3E%3C/svg%3E%3Csvg x='10' y='40' width='20' height='20' fill='none' stroke='%234b5e40' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12.732 4.232l2.536 2.536m-1.536-3.536a2 2 0 112.536 2.536L4.5 17.536H2v-2.536L12.732 4.232z'/%3E%3Cpath stroke='%23d4a017' d='M10 6l3 3'/%3E%3C/svg%3E%3Csvg x='40' y='40' width='20' height='20' fill='none' stroke='%234b5e40' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M10 11l7-4-7-4-7 4 7 4z'/%3E%3Cpath stroke='%23d4a017' d='M10 11l.01-.01M10 11l-7-4m7 4v5m-7-9v4l3 1.5m4-5.5v4l-3 1.5'/%3E%3C/svg%3E%3Csvg x='70' y='40' width='20' height='20' fill='none' stroke='%234b5e40' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M2.055 9H4a1.5 1.5 0 011.5 1.5v1a1.5 1.5 0 001.5 1.5 1.5 1.5 0 011.5 1.5v1.945M6 3.935V5a2 2 0 002 2h.5a1.5 1.5 0 011.5 1.5 1.5 1.5 0 103 0 1.5 1.5 0 011.5-1.5h.564M12 17.488V15a1.5 1.5 0 011.5-1.5h2.064M18 10a7 7 0 11-14 0 7 7 0 0114 0z'/%3E%3Cpath stroke='%23d4a017' d='M10 10h.01'/%3E%3C/svg%3E%3Csvg x='10' y='70' width='20' height='20' fill='none' stroke='%234b5e40' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M7 5h6m-3-2v14M3 4h14a1.5 1.5 0 011.5 1.5v8a1.5 1.5 0 01-1.5 1.5H3A1.5 1.5 0 011.5 6.5v-8A1.5 1.5 0 013 4z'/%3E%3Cpath stroke='%23d4a017' d='M5 9h2v2H5zm4 0h2v2H9zm4 0h2v2h-2zm-8 3h2v2H5zm4 0h2v2H9zm4 0h2v2h-2z'/%3E%3C/svg%3E%3Csvg x='40' y='70' width='20' height='20' fill='none' stroke='%234b5e40' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12.732 4.232l2.536 2.536m-1.536-3.536a2 2 0 112.536 2.536L4.5 17.536H2v-2.536L12.732 4.232z'/%3E%3Cpath stroke='%23d4a017' d='M8 8l3 3'/%3E%3C/svg%3E%3Csvg x='70' y='70' width='20' height='20' fill='none' stroke='%234b5e40' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M8 16l3-12m3 3l3 3-3 3M5 13l-3-3 3-3'/%3E%3Cpath stroke='%23d4a017' d='M10 10h.01'/%3E%3C/svg%3E%3C/g%3E%3C/svg%3E") repeat,
                  linear-gradient(to bottom right, #e6f0fa, #d1e8ff);
    }
    .content-overlay {
      background-color: rgba(255, 255, 255, 0.9);
      border-radius: 1rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background: white;
      padding: 1.5rem;
      border-radius: 0.5rem;
      max-width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
    }
    .close-modal {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
    }
  </style>
</head>
<body class="min-h-screen">
  <div id="root"></div>

  <script type="text/babel">
    function App() {
      const [isLoggedIn, setIsLoggedIn] = React.useState(false);
      const [currentPage, setCurrentPage] = React.useState('home');
      const [userSkills, setUserSkills] = React.useState({ known: '', learn: '' });
      const [testResults, setTestResults] = React.useState(null);
      const [isEligibleForSwap, setIsEligibleForSwap] = React.useState(false);
      const [matches, setMatches] = React.useState([]);
      const [chatMessages, setChatMessages] = React.useState({});
      const [currentChat, setCurrentChat] = React.useState(null);
      const [newMessage, setNewMessage] = React.useState('');
      const [scheduledCalls, setScheduledCalls] = React.useState([]);
      const [callForm, setCallForm] = React.useState({ match: '', date: '', time: '' });
      const [callFormError, setCallFormError] = React.useState('');
      const [loginForm, setLoginForm] = React.useState({ email: '', password: '' });
      const [loginError, setLoginError] = React.useState('');
      const [skillsError, setSkillsError] = React.useState('');
      const [currentUser, setCurrentUser] = React.useState(null);
      const [currentQuestion, setCurrentQuestion] = React.useState(0);
      const [answers, setAnswers] = React.useState({});
      const [timeRemaining, setTimeRemaining] = React.useState(300);
      const [showHistoryModal, setShowHistoryModal] = React.useState(false);
      const [connectionRequests, setConnectionRequests] = React.useState({});
      const [connectedMatches, setConnectedMatches] = React.useState({});
      const [sharedContent, setSharedContent] = React.useState({});

      const handleLogin = () => {
        const { email, password } = loginForm;
        if (!email || !password) {
          setLoginError('Please fill in both email and password.');
          return;
        }
        if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
          setLoginError('Please enter a valid email address.');
          return;
        }

        const mockUser = { email: 'test@skillswap.com', password: 'swap123' };
        if (email === mockUser.email && password === mockUser.password) {
          setIsLoggedIn(true);
          setCurrentPage('dashboard');
          setCurrentUser(email);
          setLoginError('');
          setLoginForm({ email: '', password: '' });
        } else {
          setLoginError('Invalid email or password.');
        }
      };

      const handleLogout = () => {
        setIsLoggedIn(false);
        setCurrentPage('home');
        setUserSkills({ known: '', learn: '' });
        setTestResults(null);
        setIsEligibleForSwap(false);
        setMatches([]);
        setChatMessages({});
        setCurrentChat(null);
        setScheduledCalls([]);
        setCurrentUser(null);
        setConnectionRequests({});
        setConnectedMatches({});
        setSharedContent({});
        localStorage.removeItem('skillSwapHistory');
      };

      const saveHistory = () => {
        const history = {
          user: currentUser,
          skills: userSkills,
          assessmentResults: testResults,
          matches: matches,
          chats: chatMessages,
          scheduledCalls: scheduledCalls,
          connectionRequests: connectionRequests,
          connectedMatches: connectedMatches,
        };
        localStorage.setItem('skillSwapHistory', JSON.stringify(history));
        alert('History saved successfully!');
      };

      const viewHistory = () => {
        setShowHistoryModal(true);
      };

      const handleSkillSubmit = () => {
        const { known, learn } = userSkills;
        if (!known || !learn.trim()) {
          setSkillsError('Please select a skill you know and enter a skill you want to learn.');
          return;
        }

        const allMatches = [
          { id: 1, name: "Jordan", known: "Programming", learn: "Mathematics", profilePic: "https://via.placeholder.com/40?text=J" },
          { id: 2, name: "Taylor", known: "Mathematics", learn: "Biology", profilePic: "https://via.placeholder.com/40?text=T" },
          { id: 3, name: "Alex", known: "Programming", learn: "Data Science", profilePic: "https://via.placeholder.com/40?text=A" },
          { id: 4, name: "Sam", known: "Physics", learn: "Chemistry", profilePic: "https://via.placeholder.com/40?text=S" },
          { id: 5, name: "Casey", known: "Chemistry", learn: "Physics", profilePic: "https://via.placeholder.com/40?text=C" },
          { id: 6, name: "Morgan", known: "Graphic Design", learn: "Web Development", profilePic: "https://via.placeholder.com/40?text=M" },
          { id: 7, name: "Riley", known: "Web Development", learn: "Graphic Design", profilePic: "https://via.placeholder.com/40?text=R" },
          { id: 8, name: "Drew", known: "Data Science", learn: "Programming", profilePic: "https://via.placeholder.com/40?text=D" },
          { id: 9, name: "Jamie", known: "Creative Writing", learn: "Photography", profilePic: "https://via.placeholder.com/40?text=J" },
          { id: 10, name: "Lee", known: "Photography", learn: "Creative Writing", profilePic: "https://via.placeholder.com/40?text=L" }
        ];

        const filteredMatches = allMatches.filter(match => match.known.toLowerCase() === known.toLowerCase());
        setMatches(filteredMatches);
        setSkillsError('');
        alert(Skills submitted! You know: ${known}, You want to learn: ${learn});
        setCurrentPage('dashboard');
      };

      const handleSendRequest = (matchId) => {
        setConnectionRequests({ ...connectionRequests, [matchId]: true });
        alert(Connection request sent to ${matches.find(m => m.id === matchId).name}!);
        setTimeout(() => {
          setConnectedMatches({ ...connectedMatches, [matchId]: true });
          alert(Request accepted by ${matches.find(m => m.id === matchId).name}! You can now chat.);
        }, 2000);
      };

      const handleLoginInputChange = (e) => {
        setLoginForm({ ...loginForm, [e.target.name]: e.target.value });
        setLoginError('');
      };

      const handleSkillInputChange = (e) => {
        setUserSkills({ ...userSkills, [e.target.name]: e.target.value });
        setSkillsError('');
      };

      const programmingQuestions = [
        { id: 1, question: "What is the difference between let and const in JavaScript?", options: ["let can be reassigned, const cannot", "const can be reassigned, let cannot", "Both can be reassigned", "Neither can be reassigned"], answer: "let can be reassigned, const cannot" },
        { id: 2, question: "What does the splice() method do in JavaScript?", options: ["Adds/removes items to/from an array", "Joins two arrays", "Maps array elements", "Filters array elements"], answer: "Adds/removes items to/from an array" },
        { id: 3, question: "In Python, what is the output of [1, 2, 3][1:2]?", options: ["[1]", "[2]", "[3]", "[1, 2]"], answer: "[2]" },
        { id: 4, question: "What is a closure in programming?", options: ["A loop structure", "A function with access to its outer scope", "A type of variable", "A database connection"], answer: "A function with access to its outer scope" },
        { id: 5, question: "What does the async keyword do in JavaScript?", options: ["Declares a synchronous function", "Declares an asynchronous function", "Pauses execution", "Creates a loop"], answer: "Declares an asynchronous function" }
      ];

      const mathematicsQuestions = [
        { id: 1, question: "What is the quadratic formula for solving ax² + bx + c = 0?", options: ["x = (-b ± √(b² - 4ac)) / (2a)", "x = (b ± √(b² - 4ac)) / (2a)", "x = (-b ± √(b² + 4ac)) / (2a)", "x = (-b ± √(b² - 4ac)) / a"], answer: "x = (-b ± √(b² - 4ac)) / (2a)" },
        { id: 2, question: "What is the value of sin(90°)?", options: ["0", "1", "-1", "√2/2"], answer: "1" },
        { id: 3, question: "What is the sum of the first 5 positive integers?", options: ["10", "15", "20", "25"], answer: "15" },
        { id: 4, question: "What is the slope of the line y = 3x + 2?", options: ["2", "3", "-3", "1"], answer: "3" },
        { id: 5, question: "What is the probability of rolling a 4 on a standard die?", options: ["1/4", "1/6", "1/3", "1/2"], answer: "1/6" }
      ];

      const biologyQuestions = [
        { id: 1, question: "What is the primary source of energy for Earth's climate system?", options: ["Geothermal energy", "Solar energy", "Nuclear energy", "Wind energy"], answer: "Solar energy" },
        { id: 2, question: "What process do plants use to convert sunlight into chemical energy?", options: ["Respiration", "Photosynthesis", "Transpiration", "Fermentation"], answer: "Photosynthesis" },
        { id: 3, question: "What is the role of RNA in protein synthesis?", options: ["It stores genetic information", "It acts as a catalyst", "It carries amino acids to ribosomes", "It provides energy"], answer: "It carries amino acids to ribosomes" },
        { id: 4, question: "What type of bond holds the two strands of DNA together?", options: ["Ionic bond", "Covalent bond", "Hydrogen bond", "Metallic bond"], answer: "Hydrogen bond" },
        { id: 5, question: "What is the term for an organism with two identical alleles for a gene?", options: ["Heterozygous", "Homozygous", "Dominant", "Recessive"], answer: "Homozygous" }
      ];

      const physicsQuestions = [
        { id: 1, question: "What is the formula for gravitational potential energy?", options: ["mgh", "1/2 mv²", "F × d", "mv"], answer: "mgh" },
        { id: 2, question: "What is the unit of electrical resistance?", options: ["Ampere", "Volt", "Ohm", "Watt"], answer: "Ohm" },
        { id: 3, question: "What does Newton's second law state?", options: ["F = ma", "Action = Reaction", "Objects at rest stay at rest", "E = mc²"], answer: "F = ma" },
        { id: 4, question: "What is the frequency of a wave with a period of 0.5 seconds?", options: ["2 Hz", "0.5 Hz", "1 Hz", "4 Hz"], answer: "2 Hz" },
        { id: 5, question: "What type of lens converges light rays?", options: ["Concave lens", "Convex lens", "Plano-concave lens", "Biconcave lens"], answer: "Convex lens" }
      ];

      const chemistryQuestions = [
        { id: 1, question: "What is the molar mass of CO₂?", options: ["28 g/mol", "32 g/mol", "44 g/mol", "48 g/mol"], answer: "44 g/mol" },
        { id: 2, question: "What type of reaction is 2H₂ + O₂ → 2H₂O?", options: ["Decomposition", "Synthesis", "Single displacement", "Double displacement"], answer: "Synthesis" },
        { id: 3, question: "What is the oxidation state of sulfur in SO₄²⁻?", options: ["+2", "+4", "+6", "+8"], answer: "+6" },
        { id: 4, question: "What gas is produced when hydrochloric acid reacts with zinc?", options: ["Oxygen", "Hydrogen", "Carbon dioxide", "Nitrogen"], answer: "Hydrogen" },
        { id: 5, question: "What is the pH of a 0.01 M HCl solution?", options: ["1", "2", "3", "4"], answer: "2" }
      ];

      const graphicDesignQuestions = [
        { id: 1, question: "What does the rule of thirds help with in design?", options: ["Color selection", "Composition balance", "Typography", "File compression"], answer: "Composition balance" },
        { id: 2, question: "What color model is used for digital screens?", options: ["CMYK", "RGB", "PANTONE", "HSB"], answer: "RGB" },
        { id: 3, question: "What is kerning in typography?", options: ["Adjusting space between lines", "Adjusting space between characters", "Choosing font styles", "Aligning text"], answer: "Adjusting space between characters" },
        { id: 4, question: "What file format supports transparency?", options: ["JPEG", "PNG", "GIF", "BMP"], answer: "PNG" },
        { id: 5, question: "What is the purpose of a mood board?", options: ["To finalize a design", "To set a project’s visual direction", "To create a logo", "To test software"], answer: "To set a project’s visual direction" }
      ];

      const webDevelopmentQuestions = [
        { id: 1, question: "What does the <div> tag do in HTML?", options: ["Creates a paragraph", "Defines a division or section", "Inserts an image", "Creates a link"], answer: "Defines a division or section" },
        { id: 2, question: "What CSS property controls the size of text?", options: ["font-weight", "font-size", "text-align", "line-height"], answer: "font-size" },
        { id: 3, question: "What is the purpose of the alt attribute in an <img> tag?", options: ["Sets image size", "Provides alternative text", "Links to another page", "Styles the image"], answer: "Provides alternative text" },
        { id: 4, question: "What does flexbox help with in CSS?", options: ["Animation", "Layout alignment", "Color management", "Typography"], answer: "Layout alignment" },
        { id: 5, question: "What HTTP status code indicates a successful request?", options: ["404", "500", "200", "301"], answer: "200" }
      ];

      const dataScienceQuestions = [
        { id: 1, question: "What does the pandas library in Python primarily do?", options: ["Data visualization", "Data manipulation and analysis", "Machine learning", "Web scraping"], answer: "Data manipulation and analysis" },
        { id: 2, question: "What is the purpose of a confusion matrix?", options: ["To visualize data", "To evaluate classification models", "To normalize data", "To split datasets"], answer: "To evaluate classification models" },
        { id: 3, question: "What does overfitting mean in machine learning?", options: ["Model performs well on training data but poorly on test data", "Model performs poorly on both training and test data", "Model is too simple", "Model has no errors"], answer: "Model performs well on training data but poorly on test data" },
        { id: 4, question: "What is the purpose of the mean in statistics?", options: ["Measures spread", "Measures central tendency", "Measures correlation", "Measures outliers"], answer: "Measures central tendency" },
        { id: 5, question: "What does SQL stand for?", options: ["Structured Query Language", "Simple Query Language", "Standard Query Language", "Structured Question Language"], answer: "Structured Query Language" }
      ];

      const creativeWritingQuestions = [
        { id: 1, question: "What is the purpose of a narrative arc?", options: ["To design characters", "To structure a story", "To create dialogue", "To choose a genre"], answer: "To structure a story" },
        { id: 2, question: "What does 'show, don’t tell' mean in writing?", options: ["Describe actions and feelings instead of stating them", "Use simple language", "Avoid metaphors", "Focus on dialogue"], answer: "Describe actions and feelings instead of stating them" },
        { id: 3, question: "What is a protagonist?", options: ["The main character", "The villain", "A supporting character", "The narrator"], answer: "The main character" },
        { id: 4, question: "What is the role of a metaphor in writing?", options: ["To compare two things directly", "To provide factual data", "To summarize a story", "To introduce characters"], answer: "To compare two things directly" },
        { id: 5, question: "What does 'point of view' refer to in a story?", options: ["The setting", "The perspective from which the story is told", "The theme", "The plot"], answer: "The perspective from which the story is told" }
      ];

      const photographyQuestions = [
        { id: 1, question: "What does the aperture control in a camera?", options: ["Shutter speed", "Depth of field", "ISO sensitivity", "White balance"], answer: "Depth of field" },
        { id: 2, question: "What does a high ISO setting do?", options: ["Increases light sensitivity", "Decreases light sensitivity", "Adjusts focus", "Changes color tone"], answer: "Increases light sensitivity" },
        { id: 3, question: "What is the purpose of the rule of thirds in photography?", options: ["To adjust exposure", "To balance composition", "To set shutter speed", "To choose lighting"], answer: "To balance composition" },
        { id: 4, question: "What does 'RAW' format mean in photography?", options: ["Unprocessed image data", "Compressed image file", "Edited image file", "Video format"], answer: "Unprocessed image data" },
        { id: 5, question: "What does shutter speed affect?", options: ["Color balance", "Motion blur", "Depth of field", "Lens focus"], answer: "Motion blur" }
      ];

      const selectedSkill = userSkills.known.toLowerCase();
      const questions = selectedSkill.includes('programming') ? programmingQuestions :
                       selectedSkill.includes('mathematics') ? mathematicsQuestions :
                       selectedSkill.includes('biology') ? biologyQuestions :
                       selectedSkill.includes('physics') ? physicsQuestions :
                       selectedSkill.includes('chemistry') ? chemistryQuestions :
                       selectedSkill.includes('graphic design') ? graphicDesignQuestions :
                       selectedSkill.includes('web development') ? webDevelopmentQuestions :
                       selectedSkill.includes('data science') ? dataScienceQuestions :
                       selectedSkill.includes('creative writing') ? creativeWritingQuestions :
                       photographyQuestions;

      const formatTime = (seconds) => {
        const minutes = Math.floor(seconds / 60);
        const secs = seconds % 60;
        return ${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')};
      };

      React.useEffect(() => {
        if (testResults || currentPage !== 'assessment') return;

        const timer = setInterval(() => {
          setTimeRemaining((prev) => {
            if (prev <= 1) {
              clearInterval(timer);
              const score = Object.keys(answers).reduce((acc, qIndex) => {
                return acc + (answers[qIndex] === questions[qIndex].answer ? 1 : 0);
              }, 0);
              setTestResults({ score, total: questions.length });
              setIsEligibleForSwap(score >= 3);
              return 0;
            }
            return prev - 1;
          });
        }, 1000);

        return () => clearInterval(timer);
      }, [testResults, currentPage]);

      const handleAnswer = (answer) => {
        const newAnswers = { ...answers, [currentQuestion]: answer };
        setAnswers(newAnswers);

        if (currentQuestion < questions.length - 1) {
          setCurrentQuestion(currentQuestion + 1);
        } else {
          const score = Object.keys(newAnswers).reduce((acc, qIndex) => {
            return acc + (newAnswers[qIndex] === questions[qIndex].answer ? 1 : 0);
          }, 0);
          setTestResults({ score, total: questions.length });
          setIsEligibleForSwap(score >= 3);
        }
      };

      const handleSendMessage = () => {
        if (!currentChat) return;
        const trimmedMessage = newMessage.trim();
        if (!trimmedMessage) {
          alert('Please enter a message before sending.');
          return;
        }
        const updatedMessages = { ...chatMessages };
        if (!updatedMessages[currentChat.id]) updatedMessages[currentChat.id] = [];
        updatedMessages[currentChat.id].push({ sender: "You", text: trimmedMessage, type: "text" });
        setChatMessages(updatedMessages);
        setNewMessage('');
        alert('Message sent successfully!');
      };

      const handleShareContent = (type) => {
        if (!currentChat) return;
        const updatedMessages = { ...chatMessages };
        if (!updatedMessages[currentChat.id]) updatedMessages[currentChat.id] = [];
        
        const contentId = Date.now();
        let content;
        if (type === 'pdf') {
          content = { sender: "You", text: Shared a PDF: StudyGuide_${contentId}.pdf, type: "pdf", contentId };
        } else {
          content = { sender: "You", text: Shared a Note: QuickNote_${contentId}.txt, type: "note", contentId };
        }
        
        updatedMessages[currentChat.id].push(content);
        setChatMessages(updatedMessages);
        
        const updatedSharedContent = { ...sharedContent };
        if (!updatedSharedContent[currentChat.id]) updatedSharedContent[currentChat.id] = [];
        updatedSharedContent[currentChat.id].push({ id: contentId, type, content: type === 'pdf' ? 'Sample PDF content' : 'Sample note content' });
        setSharedContent(updatedSharedContent);
        
        alert(${type === 'pdf' ? 'PDF' : 'Note'} shared successfully!);
      };

      const handleViewSharedContent = (contentId, chatId) => {
        const content = sharedContent[chatId]?.find(item => item.id === contentId);
        if (content) {
          alert(Viewing ${content.type}: ${content.content});
        }
      };

      const handleCallFormChange = (e) => {
        setCallForm({ ...callForm, [e.target.name]: e.target.value });
        setCallFormError('');
      };

      const handleScheduleCall = (e) => {
        e.preventDefault();
        const { match, date, time } = callForm;

        if (!match || !date || !time) {
          setCallFormError('Please fill in all fields to schedule a call.');
          return;
        }

        const currentDate = "2025-06-16";
        const currentTime = "18:57"; // 06:57 PM IST
        if (date === currentDate) {
          const [selectedHour, selectedMinute] = time.split(':').map(Number);
          const [currentHour, currentMinute] = currentTime.split(':').map(Number);
          const selectedTimeInMinutes = selectedHour * 60 + selectedMinute;
          const currentTimeInMinutes = currentHour * 60 + currentMinute;

          if (selectedTimeInMinutes <= currentTimeInMinutes) {
            setCallFormError('Cannot schedule a call in the past. Please select a time after 06:57 PM.');
            return;
          }
        }

        const newCall = { match, date, time };
        setScheduledCalls([...scheduledCalls, newCall]);
        alert(Call scheduled with ${match} on ${date} at ${time});
        setCallForm({ match: '', date: '', time: '' });
        setCallFormError('');
      };

      return (
        <div className="min-h-screen flex flex-col">
          <nav className="bg-gradient-to-r from-green-700 to-teal-500 p-4 text-white flex justify-between items-center shadow-md">
            <h1 className="text-2xl font-bold">SkillSwap</h1>
            <div>
              {isLoggedIn ? (
                <div className="flex items-center space-x-3">
                  <span className="text-sm">Hello, {currentUser}</span>
                  <button onClick={handleLogout} className="bg-red-500 px-3 py-1 rounded-md hover:bg-red-600 transition duration-300">
                    Logout
                  </button>
                </div>
              ) : (
                <button onClick={() => setCurrentPage('login')} className="bg-green-500 px-3 py-1 rounded-md hover:bg-green-600 transition duration-300">
                  Login/Signup
                </button>
              )}
            </div>
          </nav>

          {currentPage === 'home' && !isLoggedIn && (
            <div className="content-overlay relative text-center py-12 px-4 mx-4 my-6">
              <h2 className="text-4xl font-bold mb-3 text-gray-800">Welcome to SkillSwap</h2>
              <p className="text-lg mb-5 text-gray-600">Trade Skills, Grow Together – Connect and Learn!</p>
              <button
                onClick={() => setCurrentPage('login')}
                className="bg-green-500 text-white px-6 py-2 rounded-md hover:bg-green-600 transition duration-300"
              >
                Get Started
              </button>
            </div>
          )}

          {currentPage === 'login' && !isLoggedIn && (
            <div className="content-overlay relative flex justify-center items-center py-12 px-4 mx-4 my-6">
              <div className="bg-white p-6 rounded-lg w-full max-w-sm">
                <h2 className="text-2xl font-bold mb-5 text-center text-gray-800">Login / Signup</h2>
                {loginError && (
                  <p className="text-red-500 text-center mb-3">{loginError}</p>
                )}
                <div className="mb-4">
                  <label className="block text-gray-600 font-medium mb-1">Email</label>
                  <input
                    type="email"
                    name="email"
                    value={loginForm.email}
                    onChange={handleLoginInputChange}
                    className="w-full p-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-green-300"
                    placeholder="Enter your email"
                  />
                </div>
                <div className="mb-4">
                  <label className="block text-gray-600 font-medium mb-1">Password</label>
                  <input
                    type="password"
                    name="password"
                    value={loginForm.password}
                    onChange={handleLoginInputChange}
                    className="w-full p-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-green-300"
                    placeholder="Enter your password"
                  />
                </div>
                <button
                  onClick={handleLogin}
                  className="w-full bg-green-500 text-white p-2 rounded-md hover:bg-green-600 transition duration-300"
                >
                  Login / Signup
                </button>
                <p className="text-gray-500 text-center mt-3 text-sm">
                  For testing: Use email "test@skillswap.com" and password "swap123"
                </p>
              </div>
            </div>
          )}

          {currentPage === 'dashboard' && isLoggedIn && (
            <div className="content-overlay relative p-5 flex-1 mx-4 my-6">
              <h2 className="text-3xl font-bold mb-6 text-center text-gray-800">SkillSwap Dashboard</h2>
              <div className="bg-white p-6 rounded-lg mb-6">
                <h3 className="text-xl font-medium mb-4 text-gray-800">Begin Your Journey</h3>
                <div className="flex space-x-3">
                  <button
                    onClick={() => setCurrentPage('skillsEntry')}
                    className="flex-1 bg-green-500 text-white p-2 rounded-md hover:bg-green-600 transition duration-300"
                  >
                    Add Skills & Goals
                  </button>
                  <button
                    onClick={() => userSkills.known ? setCurrentPage('assessment') : alert('Please add your skills first!')}
                    className="flex-1 bg-green-500 text-white p-2 rounded-md hover:bg-green-600 transition duration-300"
                  >
                    Take Assessment
                  </button>
                  <button
                    onClick={saveHistory}
                    className="flex-1 bg-blue-500 text-white p-2 rounded-md hover:bg-blue-600 transition duration-300"
                  >
                    Save History
                  </button>
                  <button
                    onClick={viewHistory}
                    className="flex-1 bg-purple-500 text-white p-2 rounded-md hover:bg-purple-600 transition duration-300"
                  >
                    View History
                  </button>
                </div>
              </div>

              {showHistoryModal && (
                <div className="modal-overlay">
                  <div className="modal-content">
                    <button onClick={() => setShowHistoryModal(false)} className="close-modal">&times;</button>
                    <h3 className="text-xl font-medium mb-3 text-gray-800">Account History</h3>
                    <pre className="text-gray-600 text-sm whitespace-pre-wrap">
                      {JSON.stringify(JSON.parse(localStorage.getItem('skillSwapHistory') || '{}'), null, 2)}
                    </pre>
                  </div>
                </div>
              )}

              {isEligibleForSwap ? (
                <>
                  <div className="bg-white p-6 rounded-lg mb-6">
                    <h3 className="text-xl font-medium mb-3 text-gray-800">Skill Trade Matches</h3>
                    {matches.length > 0 ? (
                      <div className="space-y-3">
                        {matches.map(match => (
                          <div key={match.id} className="border p-3 rounded-md flex items-center space-x-3">
                            <img
                              src={match.profilePic}
                              alt={${match.name}'s profile}
                              className="w-10 h-10 rounded-full object-cover"
                            />
                            <div className="flex-1">
                              <p className="text-gray-800 font-medium">{match.name}</p>
                              <p className="text-gray-600 text-sm">Knows: {match.known}</p>
                              <p className="text-gray-600 text-sm">Wants to Learn: {match.learn}</p>
                            </div>
                            <div className="flex space-x-2">
                              <button
                                onClick={() => handleSendRequest(match.id)}
                                disabled={connectionRequests[match.id]}
                                className={`${
                                  connectionRequests[match.id] ? 'bg-gray-400 cursor-not-allowed' : 'bg-blue-500 hover:bg-blue-600'
                                } text-white px-3 py-1 rounded-md transition duration-300 text-sm`}
                              >
                                {connectionRequests[match.id] ? 'Request Sent' : 'Send Request'}
                              </button>
                              {connectedMatches[match.id] && (
                                <button
                                  onClick={() => setCurrentChat(match)}
                                  className="bg-green-500 text-white px-3 py-1 rounded-md hover:bg-green-600 transition duration-300 text-sm"
                                >
                                  Chat with {match.name}
                                </button>
                              )}
                            </div>
                          </div>
                        ))}
                      </div>
                    ) : (
                      <p className="text-gray-600 text-sm">No matches found for your skill. Try a different skill!</p>
                    )}
                  </div>

                  <div className="bg-white p-6 rounded-lg mb-6">
                    <h3 className="text-xl font-medium mb-3 text-gray-800">Messages</h3>
                    {currentChat ? (
                      <div>
                        <p className="text-gray-800 font-medium mb-2">Messaging {currentChat.name}</p>
                        <div className="border p-3 rounded-md h-40 overflow-y-auto mb-3">
                          {(chatMessages[currentChat.id] || []).map((msg, index) => (
                            <p key={index} className="text-gray-600 text-sm">
                              <strong>{msg.sender}:</strong>{' '}
                              {msg.type === 'text' ? (
                                msg.text
                              ) : (
                                <span
                                  className="text-blue-500 underline cursor-pointer"
                                  onClick={() => handleViewSharedContent(msg.contentId, currentChat.id)}
                                >
                                  {msg.text}
                                </span>
                              )}
                            </p>
                          ))}
                        </div>
                        <div className="flex space-x-2">
                          <input
                            type="text"
                            value={newMessage}
                            onChange={(e) => setNewMessage(e.target.value)}
                            className="flex-1 p-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-green-300"
                            placeholder="Type your message..."
                          />
                          <button
                            onClick={handleSendMessage}
                            className="bg-green-500 text-white px-3 py-2 rounded-md hover:bg-green-600 transition duration-300"
                          >
                            Send
                          </button>
                          <button
                            onClick={() => handleShareContent('pdf')}
                            className="bg-blue-500 text-white px-3 py-2 rounded-md hover:bg-blue-600 transition duration-300"
                          >
                            Share PDF
                          </button>
                          <button
                            onClick={() => handleShareContent('note')}
                            className="bg-purple-500 text-white px-3 py-2 rounded-md hover:bg-purple-600 transition duration-300"
                          >
                            Share Note
                          </button>
                        </div>
                      </div>
                    ) : (
                      <p className="text-gray-600 text-sm">Send a request to a match to start messaging!</p>
                    )}
                  </div>

                  <div className="bg-white p-6 rounded-lg">
                    <h3 className="text-xl font-medium mb-3 text-gray-800">Schedule Learning Sessions</h3>
                    <div className="mb-5">
                      <h4 className="text-lg font-medium mb-2">Book a Session</h4>
                      {callFormError && (
                        <p className="text-red-500 text-center mb-3 text-sm">{callFormError}</p>
                      )}
                      <div className="space-y-3">
                        <div>
                          <label className="block text-gray-600 font-medium mb-1 text-sm">Select Match</label>
                          <select
                            name="match"
                            value={callForm.match}
                            onChange={handleCallFormChange}
                            className="w-full p-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-green-300"
                          >
                            <option value="">Select a match</option>
                            {matches.map(match => (
                              <option key={match.id} value={match.name}>{match.name}</option>
                            ))}
                          </select>
                        </div>
                        <div>
                          <label className="block text-gray-600 font-medium mb-1 text-sm">Date</label>
                          <input
                            type="date"
                            name="date"
                            value={callForm.date}
                            onChange={handleCallFormChange}
                            className="w-full p-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-green-300"
                            min="2025-06-16"
                          />
                        </div>
                        <div>
                          <label className="block text-gray-600 font-medium mb-1 text-sm">Time</label>
                          <input
                            type="time"
                            name="time"
                            value={callForm.time}
                            onChange={handleCallFormChange}
                            className="w-full p-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-green-300"
                          />
                        </div>
                        <button
                          onClick={handleScheduleCall}
                          className="w-full bg-green-500 text-white p-2 rounded-md hover:bg-green-600 transition duration-300"
                        >
                          Schedule Session
                        </button>
                      </div>
                    </div>
                    <div>
                      <h4 className="text-lg font-medium mb-2">Upcoming Sessions</h4>
                      {scheduledCalls.length > 0 ? (
                        <div className="space-y-3">
                          {scheduledCalls.map((call, index) => (
                            <div key={index} className="border p-3 rounded-md">
                              <p className="text-gray-800 font-medium text-sm">Session with {call.match}</p>
                              <p className="text-gray-600 text-sm">Date: {call.date}</p>
                              <p className="text-gray-600 text-sm">Time: {call.time}</p>
                            </div>
                          ))}
                        </div>
                      ) : (
                        <p className="text-gray-600 text-sm">No sessions scheduled yet.</p>
                      )}
                    </div>
                  </div>
                </>
              ) : (
                <div className="bg-white p-6 rounded-lg mb-6">
                  <h3 className="text-xl font-medium mb-3 text-gray-800">Swap Eligibility</h3>
                  <p className="text-gray-600 text-sm">
                    You need a score of 3 or higher in the Assessment to access swapping features. Please take or retake the test.
                  </p>
                </div>
              )}
            </div>
          )}

          {currentPage === 'skillsEntry' && isLoggedIn && (
            <div className="content-overlay relative p-5 flex-1 mx-4 my-6">
              <h2 className="text-3xl font-bold mb-6 text-center text-gray-800">Add Your Skills & Goals</h2>
              <div className="bg-white p-6 rounded-lg mb-6">
                <h3 className="text-xl font-medium mb-4 text-gray-800">Your Skills</h3>
                {skillsError && (
                  <p className="text-red-500 text-center mb-3 text-sm">{skillsError}</p>
                )}
                <div className="mb-4">
                  <label className="block text-gray-600 font-medium mb-1 text-sm">Skills You Know</label>
                  <select
                    name="known"
                    value={userSkills.known}
                    onChange={handleSkillInputChange}
                    className="w-full p-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-green-300"
                  >
                    <option value="">Select a skill</option>
                    <option value="Programming">Programming</option>
                    <option value="Mathematics">Mathematics</option>
                    <option value="Biology">Biology</option>
                    <option value="Physics">Physics</option>
                    <option value="Chemistry">Chemistry</option>
                    <option value="Graphic Design">Graphic Design</option>
                    <option value="Web Development">Web Development</option>
                    <option value="Data Science">Data Science</option>
                    <option value="Creative Writing">Creative Writing</option>
                    <option value="Photography">Photography</option>
                  </select>
                </div>
                <div className="mb-4">
                  <label className="block text-gray-600 font-medium mb-1 text-sm">Skills You Want to Learn</label>
                  <input
                    type="text"
                    name="learn"
                    value={userSkills.learn}
                    onChange={handleSkillInputChange}
                    className="w-full p-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-green-300"
                    placeholder="e.g., Mathematics, Programming"
                  />
                </div>
                <div className="flex space-x-3">
                  <button
                    onClick={handleSkillSubmit}
                    className="flex-1 bg-green-500 text-white p-2 rounded-md hover:bg-green-600 transition duration-300"
                  >
                    Submit Skills
                  </button>
                  <button
                    onClick={() => setCurrentPage('dashboard')}
                    className="flex-1 bg-gray-500 text-white p-2 rounded-md hover:bg-gray-600 transition duration-300"
                  >
                    Back to Dashboard
                  </button>
                </div>
              </div>
            </div>
          )}

          {currentPage === 'assessment' && isLoggedIn && (
            <div className="content-overlay relative p-5 flex-1 mx-4 my-6">
              <h2 className="text-3xl font-bold mb-6 text-center text-gray-800">Skill Assessment</h2>
              <div className="bg-white p-6 rounded-lg mb-6">
                <h3 className="text-xl font-medium mb-3 text-gray-800">Test for {userSkills.known}</h3>
                {testResults ? (
                  <div>
                    <p className="text-gray-600 text-sm mb-2">Your Score: {testResults.score}/{testResults.total}</p>
                    <p className="text-gray-600 text-sm mb-2">
                      {testResults.score >= 3
                        ? "Great job! You can now swap skills."
                        : "You need a score of 3 or higher to swap skills. Please retake the test."}
                    </p>
                    <button
                      onClick={() => {
                        setTestResults(null);
                        setCurrentQuestion(0);
                        setAnswers({});
                        setTimeRemaining(300);
                        setIsEligibleForSwap(false);
                      }}
                      className="bg-green-500 text-white px-3 py-1 rounded-md hover:bg-green-600 transition duration-300 mr-2"
                    >
                      Retake Test
                    </button>
                    <button
                      onClick={() => setCurrentPage('dashboard')}
                      className="bg-gray-500 text-white px-3 py-1 rounded-md hover:bg-gray-600 transition duration-300"
                    >
                      Back to Dashboard
                    </button>
                  </div>
                ) : (
                  <div>
                    <p className="text-gray-600 text-sm mb-3 font-medium">Time Remaining: {formatTime(timeRemaining)}</p>
                    <p className="text-gray-600 text-sm mb-3">Question {currentQuestion + 1} of {questions.length}: {questions[currentQuestion].question}</p>
                    <div className="space-y-2">
                      {questions[currentQuestion].options.map((option, index) => (
                        <button
                          key={index}
                          onClick={() => handleAnswer(option)}
                          className="w-full p-2 border rounded-md text-gray-700 hover:bg-green-100 transition duration-300 text-left text-sm"
                        >
                          {option}
                        </button>
                      ))}
                    </div>
                  </div>
                )}
              </div>
            </div>
          )}

          <footer className="bg-gray-700 text-white p-3 text-center text-sm">
            <p>© 2025 SkillSwap. All rights reserved.</p>
          </footer>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>